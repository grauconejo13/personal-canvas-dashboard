"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}var widgetData=JSON.parse(localStorage.getItem("widgetData"))||{},titleEl=document.getElementById("dashboard-title"),TITLE_LIMIT=32,savedTitle=localStorage.getItem("dashboardTitle");function placeCaretAtEnd(t){t.focus(),document.getSelection().selectAllChildren(t),document.getSelection().collapseToEnd()}function setTheme(t){document.documentElement.dataset.theme=t,localStorage.setItem("theme",t)}savedTitle&&(titleEl.textContent=savedTitle),titleEl.addEventListener("input",function(){titleEl.textContent.length>TITLE_LIMIT&&(titleEl.textContent=titleEl.textContent.slice(0,TITLE_LIMIT),placeCaretAtEnd(titleEl)),localStorage.setItem("dashboardTitle",titleEl.textContent.trim())}),document.documentElement.dataset.theme=localStorage.getItem("theme")||"dark";var grid=GridStack.init({float:!0,cellHeight:120,disableOneColumnMode:!1,oneColumnSize:600}),savedLayout=JSON.parse(localStorage.getItem("layout"));function addTextWidget(){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||"widget-".concat(Date.now());grid.addWidget({w:3,h:2,content:'\n      <div class="widget" data-id="'.concat(e,'">\n        <div class="widget-header">\n          <button class="delete-btn">✕</button>\n        </div>\n        <textarea\n          class="widget-text"\n          placeholder="Write here...">').concat(t,"</textarea>\n      </div>\n    ")}),attachWidgetEvents()}function attachWidgetEvents(){document.querySelectorAll(".delete-btn").forEach(function(t){t.onclick=function(t){var e=t.target.closest(".grid-stack-item"),a=t.target.closest(".widget").dataset.id;delete widgetData[a],localStorage.setItem("widgetData",JSON.stringify(widgetData)),grid.removeWidget(e)}}),attachTextPersistence()}function attachTextPersistence(){document.querySelectorAll(".widget-text").forEach(function(t){t.oninput=function(t){var e=t.target.closest(".widget").dataset.id;widgetData[e]=t.target.value,localStorage.setItem("widgetData",JSON.stringify(widgetData))}})}function resetDashboard(){confirm("This will clear all widgets and notes. Are you sure?")&&(grid.removeAll(),localStorage.removeItem("layout"),localStorage.removeItem("widgetData"),widgetData={})}function addChecklistWidget(){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||"checklist-".concat(Date.now()),a=t.map(function(t){return'\n      <label class="check-item">\n        <input type="checkbox" '.concat(t.checked?"checked":"",' />\n        <input type="text" value="').concat(t.text,'" />\n      </label>\n    ')}).join("");grid.addWidget({w:3,h:3,content:'\n      <div class="widget" data-id="'.concat(e,'" data-type="checklist">\n        <div class="widget-header">\n          <button class="delete-btn">✕</button>\n        </div>\n        <div class="checklist">\n          ').concat(a,'\n          <button class="add-item">＋ Add item</button>\n        </div>\n      </div>\n    ')}),attachWidgetEvents(),attachChecklistEvents()}function attachChecklistEvents(){document.querySelectorAll(".widget[data-type='checklist']").forEach(function(e){function a(){var t=_toConsumableArray(e.querySelectorAll(".check-item")).map(function(t){return{text:t.querySelector("input[type='text']").value,checked:t.querySelector("input[type='checkbox']").checked}});widgetData[n]=t,localStorage.setItem("widgetData",JSON.stringify(widgetData))}var n=e.dataset.id;e.querySelectorAll("input").forEach(function(t){t.oninput=a,t.onchange=a}),e.querySelector(".add-item").onclick=function(){var t=document.createElement("label");t.className="check-item",t.innerHTML='\n        <input type="checkbox" />\n        <input type="text" placeholder="List item" />\n      ',e.querySelector(".checklist").insertBefore(t,e.querySelector(".add-item")),attachChecklistEvents(),a()}})}function hydrateWidgets(){document.querySelectorAll(".widget").forEach(function(t){var e=t.dataset.id,a=t.dataset.type;if(!a&&widgetData[e]){var n=t.querySelector(".widget-text");n&&(n.value=widgetData[e])}if("checklist"===a&&widgetData[e]){var c=t.querySelector(".checklist"),i=c.querySelector(".add-item");c.querySelectorAll(".check-item").forEach(function(t){return t.remove()}),widgetData[e].forEach(function(t){var e=document.createElement("label");e.className="check-item",e.innerHTML='\n          <input type="checkbox" '.concat(t.checked?"checked":"",' />\n          <input type="text" value="').concat(t.text,'" />\n        '),c.insertBefore(e,i)})}}),attachWidgetEvents(),attachChecklistEvents()}savedLayout&&(grid.load(savedLayout),setTimeout(hydrateWidget,100)),grid.on("change",function(){localStorage.setItem("layout",JSON.stringify(grid.save(!0)))});
//# sourceMappingURL=app.min.js.map
